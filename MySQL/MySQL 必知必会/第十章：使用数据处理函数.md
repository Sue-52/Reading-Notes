---
title: 第十章：使用数据处理函数
lang: en-US
---

# 第十章：使用数据处理函数

**一般又在 where 之后的函数。**
## 函数

与其他大多数计算机语言一样，SQL支持利用函数来处理数据。函数一般是在数据上执行的，它给数据的转换和处理提供了方便。


## 使用函数场景

大多数SQL实现支持以下类型的函数：

- 用于处理文本串（如删除或填充值，转换值为大写或小写）的文本函数。
- 用于在数值数据上进行算术操作（如返回绝对值，进行代数运算）的数值函数。
- 用于处理日期和时间值并从这些值中提取特定成分（例如，返回两个日期之差，检查日期有效性等）的日期和时间函数。
- 返回DBMS正使用的特殊信息（如返回用户登录信息，检查版本细节）的系统函数。

## 文本处理函数

| 函数 | 描述 |
|------|-----|
| left() | 返回字符串左边的字符 |
| length() | 返回字符串长度 |
| locate() | 找出字符串的子串 |
| lower() | 将字符串转换为小写 |
| Ltrim() | 去掉字符串左边空格 |
| Right() | 返回字符串右边的字符 |
| Rtrim() | 去掉字符串右边的空格 |
| soundex() | 返回字符串的 SOUNDEX 值 |
| substring() | 返回子串的字符 |
| upper() | 将字符串转换为大写 |

其中的 `SOUNDEX` 函数其意思为发音相似的值，当我们要获取值的时候写错了对应的值，但是发音和其类似，同样可以搜索到。

~~~mysql
select upper(houseCode) from houses where length(title) = 13;
~~~

## 日期和时间处理函数

| 函数 | 描述 |
|------|-----|
| AddDate() | 增加一个日期（天、周等） |
| AddTime() | 增加一个时间（时、分等） |
| CurDate() | 返回当前日期 |
| CurTime() | 返回当前时间 |
| Date() | 返回日期时间的日期部分 |
| DateDiff() | 计算两个日期之差 |
| Date_Add() | 高度灵活的日期运算函数 |
| Date_Format() | 返回一个格式化的日期或者时间串 |
| Day() | 返回一个日期的天数部分 |
| DayOfWeek() | 对于一个日期，返回对应的星期几 |
| Hour() | 返回一个时间的小时部分 |
| Minute() | 返回一个时间的分钟部分 |
| Month() | 返回一个日期的月份部分 |
| Now() | 返回当前日期时间 |
| Second() | 返回一个时间的秒部分 |
| Time() | 返回一个日期时间的时间部分 |
| Year() | 返回一个日期的年份部分 |


如果要的是日期，请使用Date() 如果你想要的仅是日期，则使用Date()是一个良好的习惯，即使你知道相应的列只包含日期也是如此。这样，如果由于某种原因表中以后有日期和时间值，你的SQL代码也不用改变。当然，也存在一个Time()函数，在你只想要时间时应该使用它。 

Date()和Time()都是在MySQL 4.1.1中第一次引入的。

~~~mysql
select str_to_date('20211018154706','%Y%m%d%H%i%s');

select date_format(date('2017-04-22 15:47:06'),'%m-%Y-%d'); 
~~~

![image-20211018164145046](https://gitee.com/sue201982/mysql/raw/master/img/202110292230212.png)

## 数值处理函数

| 函数 | 描述 |
|------|-----|
| Abs() | 返回一个数的绝对值 |
| Cos() | 返回一个角度的余弦 |
| Exp() | 返回一个数的指数值 |
| Mod() | 返回除操作的余数 |
| Pi() | 返回圆周率 |
| Rand() | 返回一个随机数 |
| Sin() | 返回一个角度的正弦 |
| Sqrt() | 返回一个数的平方根 |
| Tan() | 返回一个角度的正切 |

这些函数一般主要用于代数、三角或几何运算，因此没有串或日期—时间处理函数的使用那么频繁。

在主要DBMS的函数中，数值函数是最一致最统一的函数。

~~~mysql
select abs(-100) as "数值";
select Cos(60) as "余弦";
select Exp(60) as "指数";
select rand()*(10-1+1)+1 as "随机数";
select Sin(60) as "正弦";
select Cos(60) as "正切";
~~~